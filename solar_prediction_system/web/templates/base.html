<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>{% block title %}íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ ì‹œìŠ¤í…œ{% endblock %}</title>

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>

		<!-- Leaflet CSS -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

		<!-- Custom CSS -->
		<style>
			:root {
			    --primary-color: #2196F3;
			    --secondary-color: #4CAF50;
			    --accent-color: #FF9800;
			    --warning-color: #F44336;
			    --success-color: #81C784;
			    --info-color: #81D4FA;
			}

			body {
			    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
			    background-color: #f8f9fa;
			}

			.navbar-brand {
			    font-weight: bold;
			    font-size: 1.2rem;
			}

			.loading {
			    display: none;
			    position: fixed;
			    top: 0;
			    left: 0;
			    width: 100%;
			    height: 100%;
			    background-color: rgba(0,0,0,0.5);
			    z-index: 2000;
			    justify-content: center;
			    align-items: center;
			    color: white;
			}

			.loader {
			    border: 4px solid #f3f3f3;
			    border-top: 4px solid var(--primary-color);
			    border-radius: 50%;
			    width: 50px;
			    height: 50px;
			    animation: spin 2s linear infinite;
			    margin-bottom: 20px;
			}

			@keyframes spin {
			    0% { transform: rotate(0deg); }
			    100% { transform: rotate(360deg); }
			}

			.chart-container {
			    background-color: white;
			    border-radius: 8px;
			    padding: 20px;
			    margin: 20px 0;
			    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
			}

			.metric-card {
			    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
			    color: white;
			    border-radius: 10px;
			    padding: 20px;
			    margin: 10px 0;
			    text-align: center;
			}

			.metric-value {
			    font-size: 2rem;
			    font-weight: bold;
			    margin-bottom: 5px;
			}

			.metric-label {
			    font-size: 0.9rem;
			    opacity: 0.9;
			}

			.btn-primary {
			    background-color: var(--primary-color);
			    border-color: var(--primary-color);
			}

			.btn-success {
			    background-color: var(--secondary-color);
			    border-color: var(--secondary-color);
			}

			.alert-info {
			    background-color: var(--info-color);
			    border-color: var(--info-color);
			}

			.footer {
			    background-color: #343a40;
			    color: white;
			    padding: 40px 0;
			    margin-top: 50px;
			}

			{% block extra_css %}{% endblock %}
		</style>
	</head>
	<body>
		<!-- ë¡œë”© ì¸ë””ì¼€ì´í„° -->
		<div class="loading" id="loadingIndicator">
			<div style="text-align: center">
				<div class="loader"></div>
				<div>ì²˜ë¦¬ ì¤‘...</div>
			</div>
		</div>

		<!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
		<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
			<div class="container">
				<a class="navbar-brand" href="{{ url_for('main.index') }}">
					â˜€ï¸ íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡
				</a>

				<button
					class="navbar-toggler"
					type="button"
					data-bs-toggle="collapse"
					data-bs-target="#navbarNav"
				>
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav me-auto">
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('main.index') }}">ğŸ  í™ˆ</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('main.heatmap') }}"
								>ğŸ”¥ íˆíŠ¸ë§µ</a
							>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('design.system_designer') }}"
								>âš¡ ì‹œìŠ¤í…œ ì„¤ê³„</a
							>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('download.download_page') }}"
								>ğŸ“¥ ë°ì´í„° ë‹¤ìš´ë¡œë“œ</a
							>
						</li>
					</ul>

					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('main.help_page') }}"
								>â“ ë„ì›€ë§</a
							>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="{{ url_for('main.about') }}">â„¹ï¸ ì •ë³´</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- ë©”ì¸ ì»¨í…ì¸  -->
		<main>{% block content %}{% endblock %}</main>

		<!-- í‘¸í„° -->
		<footer class="footer">
			<div class="container">
				<div class="row">
					<div class="col-md-6">
						<h5>íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ ì‹œìŠ¤í…œ</h5>
						<p>
							NASA POWER APIì™€ pvlibë¥¼ í™œìš©í•œ ê³ ì •ë°€ íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ ì„œë¹„ìŠ¤
						</p>
					</div>
					<div class="col-md-3">
						<h6>ì£¼ìš” ê¸°ëŠ¥</h6>
						<ul class="list-unstyled">
							<li>
								<a href="{{ url_for('main.index') }}" class="text-light"
									>ë°œì „ëŸ‰ ì˜ˆì¸¡</a
								>
							</li>
							<li>
								<a href="{{ url_for('main.heatmap') }}" class="text-light"
									>ì§€ì—­ë³„ íˆíŠ¸ë§µ</a
								>
							</li>
							<li>
								<a
									href="{{ url_for('design.system_designer') }}"
									class="text-light"
									>ì‹œìŠ¤í…œ ì„¤ê³„</a
								>
							</li>
							<li>
								<a
									href="{{ url_for('download.download_page') }}"
									class="text-light"
									>ë°ì´í„° ë‹¤ìš´ë¡œë“œ</a
								>
							</li>
						</ul>
					</div>
					<div class="col-md-3">
						<h6>ì •ë³´</h6>
						<ul class="list-unstyled">
							<li>
								<a href="{{ url_for('main.about') }}" class="text-light"
									>ì„œë¹„ìŠ¤ ì†Œê°œ</a
								>
							</li>
							<li>
								<a href="{{ url_for('main.help_page') }}" class="text-light"
									>ì‚¬ìš©ë²• ì•ˆë‚´</a
								>
							</li>
							<li><a href="#" class="text-light">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
							<li><a href="#" class="text-light">ì´ìš©ì•½ê´€</a></li>
						</ul>
					</div>
				</div>
				<hr />
				<div class="row">
					<div class="col-12 text-center">
						<p>
							&copy; 2024 íƒœì–‘ê´‘ ë°œì „ëŸ‰ ì˜ˆì¸¡ ì‹œìŠ¤í…œ. êµìœ¡ ë° ì—°êµ¬ ëª©ì ìœ¼ë¡œ
							ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
						</p>
					</div>
				</div>
			</div>
		</footer>

		<!-- JavaScript Libraries -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
		{% block extra_js %}{% endblock %}

		<!-- Common JavaScript Functions -->
		<script>
			// ë¡œë”© ì¸ë””ì¼€ì´í„° í•¨ìˆ˜
			function showLoading(message = 'ì²˜ë¦¬ ì¤‘...') {
			    const loadingEl = document.getElementById('loadingIndicator');
			    loadingEl.querySelector('div div:last-child').textContent = message;
			    loadingEl.style.display = 'flex';
			}

			function hideLoading() {
			    document.getElementById('loadingIndicator').style.display = 'none';
			}

			// ì•Œë¦¼ ë©”ì‹œì§€ í•¨ìˆ˜
			function showAlert(message, type = 'info') {
			    const alertDiv = document.createElement('div');
			    alertDiv.className = `alert alert-${type} alert-dismissible fade show`;
			    alertDiv.innerHTML = `
			        ${message}
			        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			    `;

			    // í˜ì´ì§€ ìƒë‹¨ì— ì¶”ê°€
			    document.querySelector('main').insertBefore(alertDiv, document.querySelector('main').firstChild);

			    // 5ì´ˆ í›„ ìë™ ì œê±°
			    setTimeout(() => {
			        if (alertDiv.parentNode) {
			            alertDiv.remove();
			        }
			    }, 5000);
			}

			// ìˆ«ì í¬ë§·íŒ… í•¨ìˆ˜
			function formatNumber(num) {
			    return new Intl.NumberFormat('ko-KR').format(num);
			}

			// ì—ëŸ¬ ì²˜ë¦¬ í•¨ìˆ˜
			function handleApiError(error, context = '') {
			    console.error(`API ì˜¤ë¥˜ ${context}:`, error);
			    hideLoading();

			    let message = 'ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
			    if (error.response && error.response.data && error.response.data.error) {
			        message = error.response.data.error;
			    } else if (error.message) {
			        message = error.message;
			    }

			    showAlert(message, 'danger');
			}

			// ìœ„ì¹˜ ìœ íš¨ì„± ê²€ì¦ í•¨ìˆ˜
			function validateCoordinates(lat, lon) {
			    if (isNaN(lat) || isNaN(lon)) {
			        return false;
			    }

			    if (lat < -90 || lat > 90 || lon < -180 || lon > 180) {
			        return false;
			    }

			    return true;
			}

			// ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í—¬í¼ í•¨ìˆ˜ (ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°ì—ë§Œ)
			function saveToLocalStorage(key, value) {
			    try {
			        if (typeof(Storage) !== "undefined") {
			            localStorage.setItem(key, JSON.stringify(value));
			        }
			    } catch (e) {
			        console.log('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥ ì‹¤íŒ¨:', e);
			    }
			}

			function loadFromLocalStorage(key) {
			    try {
			        if (typeof(Storage) !== "undefined") {
			            const item = localStorage.getItem(key);
			            return item ? JSON.parse(item) : null;
			        }
			    } catch (e) {
			        console.log('ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë¡œë“œ ì‹¤íŒ¨:', e);
			    }
			    return null;
			}

			{% block extra_scripts %}{% endblock %}
		</script>
	</body>
</html>
